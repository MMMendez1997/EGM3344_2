clc;clear

xl = .2;
xu = .5;
cp = 1.1;
num = (.99403 + ((1.671*(10^-4))*xu) + ((9.7215*(10^-8))*(xu.^2)) - ((9.5838*(10^-11))*(xu.^3)) + ((1.952*(10^-14))*(xu.^4)) - cp)*(xu-xl);
den = (.99403 + ((1.671*(10^-4))*xu) + ((9.7215*(10^-8))*(xu.^2)) - ((9.5838*(10^-11))*(xu.^3)) + ((1.952*(10^-14))*(xu.^4)) - cp)-(.99403 + ((1.671*(10^-4))*xl) + ((9.7215*(10^-8))*(xl.^2)) - ((9.5838*(10^-11))*(xl.^3)) + ((1.952*(10^-14))*(xl.^4)) - cp);
xm = xu - (num/den);

iter = 0;
error = 1;
while error > 10^-8
    if (.99403 + ((1.671*(10^-4))*xl) + ((9.7215*(10^-8))*(xl.^2)) - ((9.5838*(10^-11))*(xl.^3)) + ((1.952*(10^-14))*(xl.^4)) - cp)*(.99403 + ((1.671*(10^-4))*xm) + ((9.7215*(10^-8))*(xm.^2)) - ((9.5838*(10^-11))*(xm.^3)) + ((1.952*(10^-14))*(xm.^4)) - cp) < 0
        xu = xm;
    else
        xl = xm;
    end
    xm_prev = xm;
    num = (.99403 + ((1.671*(10^-4))*xu) + ((9.7215*(10^-8))*(xu.^2)) - ((9.5838*(10^-11))*(xu.^3)) + ((1.952*(10^-14))*(xu.^4)) - cp)*(xu-xl);
    den = (.99403 + ((1.671*(10^-4))*xu) + ((9.7215*(10^-8))*(xu.^2)) - ((9.5838*(10^-11))*(xu.^3)) + ((1.952*(10^-14))*(xu.^4)) - cp)-(.99403 + ((1.671*(10^-4))*xl) + ((9.7215*(10^-8))*(xl.^2)) - ((9.5838*(10^-11))*(xl.^3)) + ((1.952*(10^-14))*(xl.^4)) - cp);
    xm = xu - (num/den);
    error = abs((xm-xm_prev)/xm);
    iter = iter + 1;
end

T = 0:1200;
f = .99403 + ((1.671*(10^-4))*T) + ((9.7215*(10^-8))*(T.^2)) - ((9.5838*(10^-11))*(T.^3)) + ((1.952*(10^-14))*(T.^4));
hold on
plot(T,f,'k--')
plot(0:xu,cp,'rx-','markersize',1)
plot(xu,.95:.0005:cp,'rx-','markersize',1)
xlabel('Temperature (K)')
ylabel('Zero Pressure Specific Heat of Dry Air (kJ/(kg K)')
legend('show','Function','Root','location','southeast')
hold off